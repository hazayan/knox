\* TLC Model Checking Configuration for MasterKeyRotation

\* Constants
CONSTANTS
    MaxKeys = 3
    MaxCryptors = 3
    KeyIDs = {k1, k2, k3}
    CryptorIDs = {c1, c2, c3}

\* Invariants to check
INVARIANTS
    Invariants
    NoDecryptionFailures
    CurrentNotInOld
    UniqueOldCryptors
    ReencryptingValid
    ReencryptedConsistency

\* Properties to check
PROPERTIES
    AlwaysCanDecrypt
    AlwaysDistinctCryptors
    NewWritesUseCurrentCryptor
    SafeRemoval

\* Specification
SPECIFICATION Spec

\* State constraints
CONSTRAINT Cardinality(database) <= MaxKeys
CONSTRAINT Len(oldCryptors) <= MaxCryptors
